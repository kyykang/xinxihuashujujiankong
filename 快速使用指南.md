# 快速使用指南

## 🚀 5分钟快速上手

### 1. 启动系统

```bash
python3 app.py
```

系统将在 http://localhost:8080 启动

### 2. 首次登录

打开浏览器访问 http://localhost:8080

**默认管理员账户**：
- 用户名: `admin`
- 密码: `admin123`

⚠️ **重要**: 首次登录后请立即修改密码！

### 3. 修改密码

1. 点击右上角的设置图标（齿轮）
2. 选择"修改密码"
3. 输入原密码：`admin123`
4. 输入新密码（至少6位）
5. 确认新密码
6. 点击"修改密码"
7. 使用新密码重新登录

### 4. 添加只读用户

#### 方法A：使用Web界面（推荐）

1. 点击左侧菜单"用户管理"
2. 点击"添加用户"按钮
3. 填写信息：
   ```
   用户名: viewer
   邮箱: viewer@example.com
   密码: viewer123
   管理员权限: 不勾选
   ```
4. 点击"保存"

#### 方法B：使用命令行

```bash
python3 add_user.py viewer viewer123 "viewer@example.com" 0
```

### 5. 测试只读权限

1. 退出当前账户
2. 使用 `viewer/viewer123` 登录
3. 你会发现：
   - ✅ 可以查看所有监控数据
   - ❌ 看不到"添加监控目标"按钮
   - ❌ 看不到"编辑"和"删除"按钮
   - ❌ 看不到"用户管理"菜单

### 6. 添加监控目标

使用管理员账户登录后：

#### 监控服务器

1. 点击"监控目标" -> "添加监控目标"
2. 选择类型：服务器
3. 填写信息：
   ```
   名称: 生产服务器
   是否远程: 勾选
   主机地址: 192.168.1.100
   SSH端口: 22
   用户名: root
   密码: ******
   ```
4. 点击"测试连接"验证
5. 点击"保存"

#### 监控应用

1. 选择类型：应用
2. 填写信息：
   ```
   名称: 公司官网
   URL: https://www.example.com
   ```
3. 点击"测试连接"
4. 点击"保存"

#### 监控数据库

1. 选择类型：数据库
2. 填写信息：
   ```
   名称: 生产数据库
   数据库类型: MySQL
   主机地址: 192.168.1.101
   端口: 3306
   用户名: monitor
   密码: ******
   数据库名: production
   ```
3. 点击"测试连接"
4. 点击"保存"

#### 监控业务指标

1. 选择类型：业务指标
2. 填写信息：
   ```
   名称: 今日订单数
   数据库类型: MySQL
   主机地址: 192.168.1.101
   端口: 3306
   用户名: monitor
   密码: ******
   数据库名: business
   SQL查询: SELECT COUNT(*) FROM orders WHERE DATE(created_at) = CURDATE()
   告警阈值: 100
   告警条件: 小于
   ```
3. 点击"测试连接"
4. 点击"保存"

### 7. 查看监控仪表板

1. 点击"监控仪表板"
2. 查看所有监控目标的实时状态
3. 拖拽卡片调整布局
4. 系统每30秒自动刷新

### 8. 配置企业微信告警（可选）

1. 点击"系统配置"
2. 填写企业微信配置：
   ```
   企业ID: ww123456789
   应用AgentId: 1000001
   应用Secret: ******
   ```
3. 点击"保存配置"

## 📋 常用操作

### 查看告警记录

点击"告警记录"查看所有历史告警

### 清除告警记录

1. 点击"告警记录"
2. 点击"清除告警记录"按钮
3. 选择清除范围：
   - 全部记录
   - 7天前
   - 30天前
   - 90天前
   - 已解决的告警
4. 确认清除

### 编辑监控目标

1. 点击"监控目标"
2. 找到要编辑的目标
3. 点击"编辑"按钮
4. 修改配置
5. 点击"保存"

### 删除监控目标

1. 点击"监控目标"
2. 找到要删除的目标
3. 点击"删除"按钮
4. 确认删除

### 启用/禁用监控目标

1. 点击"监控目标"
2. 找到要操作的目标
3. 点击"编辑"按钮
4. 勾选/取消勾选"启用"
5. 点击"保存"

## 🔧 系统配置

### 修改检查间隔

1. 点击"系统配置"
2. 修改"检查间隔（秒）"
3. 点击"保存配置"
4. 重启系统使配置生效

### 修改告警阈值

1. 点击"系统配置"
2. 修改各项阈值：
   - CPU使用率阈值
   - 内存使用率阈值
   - 磁盘使用率阈值
   - 响应时间阈值
3. 点击"保存配置"

### 修改时区

1. 点击"系统配置"
2. 选择时区（默认：中国标准时间 UTC+8）
3. 点击"保存配置"

## 👥 用户管理

### 查看所有用户

1. 使用管理员账户登录
2. 点击"用户管理"
3. 查看用户列表

### 编辑用户

1. 在用户列表中找到用户
2. 点击"编辑"
3. 修改信息
4. 点击"保存"

### 删除用户

1. 在用户列表中找到用户
2. 点击"删除"
3. 确认删除

⚠️ **注意**: 不能删除当前登录的用户

### 重置用户密码

管理员可以通过编辑用户来重置密码：

1. 点击"编辑"
2. 输入新密码
3. 点击"保存"

## 🎯 使用场景示例

### 场景1：监控Web服务器集群

1. 添加多个服务器监控目标
2. 设置CPU和内存告警阈值
3. 配置企业微信告警
4. 在仪表板查看所有服务器状态

### 场景2：监控业务关键指标

1. 添加业务指标监控（如订单数、用户数）
2. 设置合理的告警阈值
3. 定期查看仪表板
4. 分析历史数据趋势

### 场景3：团队协作监控

1. 管理员配置所有监控目标
2. 为团队成员创建只读账户
3. 团队成员查看监控数据
4. 发现问题及时通知管理员

### 场景4：大屏展示

1. 创建专用的只读账户
2. 在大屏上打开监控仪表板
3. 设置自动刷新
4. 实时展示监控状态

## 🆘 常见问题

### Q: 忘记管理员密码怎么办？

A: 使用以下脚本重置：

```python
# reset_password.py
import sqlite3
from werkzeug.security import generate_password_hash

conn = sqlite3.connect('monitoring.db')
cursor = conn.cursor()
new_password_hash = generate_password_hash('admin123', method='pbkdf2:sha256')
cursor.execute('UPDATE users SET password_hash = ? WHERE username = ?', 
               (new_password_hash, 'admin'))
conn.commit()
conn.close()
print('密码已重置为: admin123')
```

运行：`python3 reset_password.py`

### Q: 如何备份数据？

A: 直接复制数据库文件：

```bash
cp monitoring.db monitoring.db.backup
```

### Q: 如何恢复数据？

A: 替换数据库文件：

```bash
cp monitoring.db.backup monitoring.db
```

### Q: 监控数据保存多久？

A: 默认保存所有历史数据。可以通过"清除告警记录"功能清理旧数据。

### Q: 如何修改端口？

A: 编辑 `app.py` 最后一行：

```python
app.run(host='0.0.0.0', port=8080, debug=True)
```

改为你想要的端口，然后重启系统。

### Q: 普通用户能修改自己的密码吗？

A: 可以。所有用户都可以通过右上角设置菜单修改自己的密码。

### Q: 如何添加更多管理员？

A: 使用命令行或Web界面添加用户时，勾选"管理员权限"即可。

## 📚 更多文档

- [README.md](README.md) - 完整功能说明
- [用户管理功能说明.md](用户管理功能说明.md) - 用户管理详细说明
- [用户权限管理说明.md](用户权限管理说明.md) - 权限控制详细说明
- [安全配置说明.md](安全配置说明.md) - 安全功能说明
- [CHANGELOG.md](CHANGELOG.md) - 更新日志

## 💡 提示

1. **定期备份数据库**：建议每天备份一次
2. **定期更换密码**：建议每3个月更换一次
3. **合理设置阈值**：根据实际情况调整告警阈值
4. **及时处理告警**：收到告警后及时处理
5. **定期清理数据**：定期清理旧的告警记录
6. **最小权限原则**：只给需要的人分配管理员权限
7. **监控系统本身**：确保监控系统正常运行

## 🎉 开始使用

现在你已经了解了基本操作，开始使用系统吧！

如有问题，请查看详细文档或联系系统管理员。
